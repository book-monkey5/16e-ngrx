"use strict";(self.webpackChunkbook_monkey=self.webpackChunkbook_monkey||[]).push([[61],{6061:(no,p,i)=>{i.r(p),i.d(p,{BooksModule:()=>oo});var r=i(6895),u=i(3841),o=i(4650),g=i(6384);let _=(()=>{class t{constructor(){this.confirm=new o.vpe}onClick(){window.confirm(this.confirmText)&&this.confirm.emit()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=o.lG2({type:t,selectors:[["","bmConfirm",""]],hostBindings:function(n,c){1&n&&o.NdJ("click",function(){return c.onClick()})},inputs:{confirmText:["bmConfirm","confirmText"]},outputs:{confirm:"confirm"}}),t})();var Z=i(7579),x=i(2722),C=i(8338);let T=(()=>{class t{constructor(n,c,a){this.template=n,this.viewContainer=c,this.authService=a,this.destroy$=new Z.x,this.authService.isAuthenticated$.pipe((0,x.R)(this.destroy$)).subscribe(l=>{l?this.viewContainer.createEmbeddedView(this.template):this.viewContainer.clear()})}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(o.Rgc),o.Y36(o.s_b),o.Y36(C.e))},t.\u0275dir=o.lG2({type:t,selectors:[["","bmLoggedinOnly",""]]}),t})(),k=(()=>{class t{transform(n){return n?`${n.substring(0,3)}-${n.substring(3)}`:""}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275pipe=o.Yjl({name:"isbn",type:t,pure:!0}),t})();function L(t,e){if(1&t&&(o.TgZ(0,"p",9),o._uU(1),o.qZA()),2&t){const n=o.oxw().ngIf;o.xp6(1),o.Oqu(n.subtitle)}}function y(t,e){if(1&t&&(o.TgZ(0,"li"),o._uU(1),o.qZA()),2&t){const n=e.$implicit;o.xp6(1),o.Oqu(n)}}function I(t,e){if(1&t&&(o.TgZ(0,"div")(1,"h2"),o._uU(2,"Published"),o.qZA(),o._uU(3),o.ALo(4,"date"),o.qZA()),2&t){const n=o.oxw().ngIf;o.xp6(3),o.hij(" ",o.xi3(4,1,n.published,"longDate")," ")}}function A(t,e){if(1&t&&o._UZ(0,"img",10),2&t){const n=o.oxw().ngIf;o.Q6J("src",n.thumbnailUrl,o.LSH)}}const U=function(t){return["/admin/edit",t]};function F(t,e){if(1&t){const n=o.EpF();o.ynx(0),o.TgZ(1,"button",11),o.NdJ("confirm",function(){o.CHM(n);const a=o.oxw().ngIf,l=o.oxw();return o.KtG(l.removeBook(a.isbn))}),o._uU(2," Remove book "),o.qZA(),o.TgZ(3,"a",12),o._uU(4," Edit book "),o.qZA(),o.BQk()}if(2&t){const n=o.oxw().ngIf;o.xp6(3),o.Q6J("routerLink",o.VKq(1,U,n.isbn))}}function Y(t,e){if(1&t&&(o.TgZ(0,"div",1)(1,"h1"),o._uU(2),o.qZA(),o.YNc(3,L,2,1,"p",2),o.TgZ(4,"div",3)(5,"div")(6,"h2"),o._uU(7,"Authors"),o.qZA(),o.TgZ(8,"ul"),o.YNc(9,y,2,1,"li",4),o.qZA()(),o.TgZ(10,"div")(11,"h2"),o._uU(12,"ISBN"),o.qZA(),o._uU(13),o.ALo(14,"isbn"),o.qZA(),o.YNc(15,I,5,4,"div",5),o.qZA(),o.TgZ(16,"h2"),o._uU(17,"Description"),o.qZA(),o.TgZ(18,"p"),o._uU(19),o.qZA(),o.YNc(20,A,1,1,"img",6),o.TgZ(21,"a",7),o._uU(22,"Back to list"),o.qZA(),o.YNc(23,F,5,3,"ng-container",8),o.qZA()),2&t){const n=e.ngIf;o.xp6(2),o.Oqu(n.title),o.xp6(1),o.Q6J("ngIf",n.subtitle),o.xp6(6),o.Q6J("ngForOf",n.authors),o.xp6(4),o.hij(" ",o.lcZ(14,7,n.isbn)," "),o.xp6(2),o.Q6J("ngIf",n.published),o.xp6(4),o.Oqu(n.description),o.xp6(1),o.Q6J("ngIf",n.thumbnailUrl)}}let D=(()=>{class t{constructor(n,c,a){this.service=n,this.route=c,this.router=a;const l=this.route.snapshot.paramMap.get("isbn");this.book$=this.service.getSingle(l)}removeBook(n){this.service.remove(n).subscribe(()=>{this.router.navigateByUrl("/books")})}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(g.T),o.Y36(u.gz),o.Y36(u.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["bm-book-details"]],decls:2,vars:3,consts:[["class","details",4,"ngIf"],[1,"details"],["role","doc-subtitle",4,"ngIf"],[1,"header"],[4,"ngFor","ngForOf"],[4,"ngIf"],["alt","Cover",3,"src",4,"ngIf"],["routerLink","..",1,"button","arrow-left"],[4,"bmLoggedinOnly"],["role","doc-subtitle"],["alt","Cover",3,"src"],["bmConfirm","Remove book?",1,"red",3,"confirm"],[1,"button",3,"routerLink"]],template:function(n,c){1&n&&(o.YNc(0,Y,24,9,"div",0),o.ALo(1,"async")),2&n&&o.Q6J("ngIf",o.lcZ(1,1,c.book$))},dependencies:[r.sg,r.O5,u.yS,_,T,r.Ov,r.uU,k]}),t})();var s=i(9653);const m=(0,s.PH)("[Book] Load Books"),d=(0,s.PH)("[Book] Load Books Success",(0,s.Ky)()),b=(0,s.PH)("[Book] Load Books Failure",(0,s.Ky)()),h="book",O=(0,s.Lq)({books:[],loading:!1},(0,s.on)(m,t=>({...t,loading:!0})),(0,s.on)(d,(t,e)=>({...t,books:e.data,loading:!1})),(0,s.on)(b,(t,e)=>({...t,loading:!1}))),v=(0,s.ZF)(h),Q=(0,s.P1)(v,t=>t.loading),B=(0,s.P1)(v,t=>t.books);function N(t,e){if(1&t&&o._UZ(0,"img",6),2&t){const n=o.oxw(2);o.Q6J("src",n.book.thumbnailUrl,o.LSH)}}function q(t,e){if(1&t&&(o.TgZ(0,"p",7),o._uU(1),o.qZA()),2&t){const n=o.oxw(2);o.xp6(1),o.hij(" ",n.book.subtitle," ")}}function $(t,e){if(1&t&&(o.TgZ(0,"li"),o._uU(1),o.qZA()),2&t){const n=e.$implicit;o.xp6(1),o.hij(" ",n," ")}}function w(t,e){if(1&t&&(o.TgZ(0,"a",1),o.YNc(1,N,1,1,"img",2),o.TgZ(2,"h2"),o._uU(3),o.qZA(),o.YNc(4,q,2,1,"p",3),o.TgZ(5,"ul",4),o.YNc(6,$,2,1,"li",5),o.qZA(),o.TgZ(7,"div"),o._uU(8),o.ALo(9,"isbn"),o.qZA()()),2&t){const n=o.oxw();o.Q6J("routerLink",n.book.isbn),o.xp6(1),o.Q6J("ngIf",n.book.thumbnailUrl),o.xp6(2),o.Oqu(n.book.title),o.xp6(1),o.Q6J("ngIf",n.book.subtitle),o.xp6(2),o.Q6J("ngForOf",n.book.authors),o.xp6(2),o.hij("ISBN ",o.lcZ(9,6,n.book.isbn),"")}}let S=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["bm-book-list-item"]],inputs:{book:"book"},decls:1,vars:1,consts:[[3,"routerLink",4,"ngIf"],[3,"routerLink"],["alt","Cover",3,"src",4,"ngIf"],["role","doc-subtitle",4,"ngIf"],[1,"comma-list"],[4,"ngFor","ngForOf"],["alt","Cover",3,"src"],["role","doc-subtitle"]],template:function(n,c){1&n&&o.YNc(0,w,10,8,"a",0),2&n&&o.Q6J("ngIf",c.book)},dependencies:[r.sg,r.O5,u.yS,k]}),t})();function M(t,e){if(1&t&&(o.TgZ(0,"li"),o._UZ(1,"bm-book-list-item",5),o.qZA()),2&t){const n=e.$implicit;o.xp6(1),o.Q6J("book",n)}}function j(t,e){1&t&&(o.TgZ(0,"li"),o._uU(1," No books available. "),o.qZA())}function H(t,e){if(1&t&&(o.TgZ(0,"ul",2),o.YNc(1,M,2,1,"li",3),o.YNc(2,j,2,0,"li",4),o.qZA()),2&t){const n=e.ngIf;o.xp6(1),o.Q6J("ngForOf",n),o.xp6(1),o.Q6J("ngIf",!n.length)}}function P(t,e){1&t&&(o.TgZ(0,"div",6),o._uU(1,"Loading ..."),o.qZA())}const E=[{path:"",component:(()=>{class t{constructor(n){this.store=n,this.books$=this.store.select(B),this.loading$=this.store.select(Q),this.store.dispatch(m())}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(s.yh))},t.\u0275cmp=o.Xpm({type:t,selectors:[["bm-book-list"]],decls:6,vars:6,consts:[["class","book-list",4,"ngIf"],["class","loader",4,"ngIf"],[1,"book-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"book"],[1,"loader"]],template:function(n,c){1&n&&(o.TgZ(0,"h1"),o._uU(1,"Books"),o.qZA(),o.YNc(2,H,3,2,"ul",0),o.ALo(3,"async"),o.YNc(4,P,2,0,"div",1),o.ALo(5,"async")),2&n&&(o.xp6(2),o.Q6J("ngIf",o.lcZ(3,2,c.books$)),o.xp6(2),o.Q6J("ngIf",o.lcZ(5,4,c.loading$)))},dependencies:[r.sg,r.O5,S,r.Ov]}),t})()},{path:":isbn",component:D}];let G=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[u.Bz.forChild(E),u.Bz]}),t})();var f=i(2655),R=i(9300),K=i(3900),z=i(4004),X=i(262),V=i(9646);let W=(()=>{class t{constructor(n,c,a){this.actions$=n,this.service=c,this.store=a,this.loadBooks$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(m),(0,f.IC)(()=>this.store.select(B)),(0,R.h)(([l,to])=>!to.length),(0,K.w)(()=>this.service.getAll().pipe((0,z.U)(l=>d({data:l})),(0,X.K)(l=>(0,V.of)(b({error:l.message})))))))}}return t.\u0275fac=function(n){return new(n||t)(o.LFG(f.eX),o.LFG(g.T),o.LFG(s.yh))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t})(),oo=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[r.ez,G,s.Aw.forFeature(h,O),f.sQ.forFeature([W])]}),t})()}}]);