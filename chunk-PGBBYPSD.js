import{b as T,c as U,l as pt,m as V,n as lt,o as ft,p as $,q as dt,r as ut,s as kt,t as vt,u as bt,v as Bt}from"./chunk-MXA4WOOO.js";import{$a as H,Aa as v,Ba as b,Ea as st,F as J,Fa as d,G as Q,Ga as u,Ha as at,L as W,M as S,Na as x,O as P,Oa as I,Pa as w,Qa as mt,R as _,Ra as ct,S as L,T as E,U as X,Wa as gt,Y,Ya as _t,Z,Za as A,a as h,ab as M,b as y,ca as tt,d as K,da as D,ea as n,fa as f,ga as et,ja as ot,k as z,m as q,ma as c,oa as m,qa as r,r as G,ra as i,sa as B,ta as it,ua as nt,va as rt,wa as F,xa as l,za as s}from"./chunk-AT2FGDAP.js";var xt=(()=>{class t{confirmText;confirm=new tt;onClick(){window.confirm(this.confirmText)&&this.confirm.emit()}static \u0275fac=function(o){return new(o||t)};static \u0275dir=E({type:t,selectors:[["","bmConfirm",""]],hostBindings:function(o,p){o&1&&F("click",function(){return p.onClick()})},inputs:{confirmText:[0,"bmConfirm","confirmText"]},outputs:{confirm:"confirm"}})}return t})();var It=(()=>{class t{template;viewContainer;authService;destroy$=new K;constructor(e,o,p){this.template=e,this.viewContainer=o,this.authService=p,this.authService.isAuthenticated$.pipe(Q(this.destroy$)).subscribe(g=>{g?this.viewContainer.createEmbeddedView(this.template):this.viewContainer.clear()})}ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(o){return new(o||t)(f(et),f(ot),f(Bt))};static \u0275dir=E({type:t,selectors:[["","bmLoggedinOnly",""]]})}return t})();var j=(()=>{class t{transform(e){return e?`${e.substring(0,3)}-${e.substring(3)}`:""}static \u0275fac=function(o){return new(o||t)};static \u0275pipe=X({name:"isbn",type:t,pure:!0})}return t})();var Pt=t=>["/admin/edit",t];function Ut(t,a){if(t&1&&(r(0,"p",9),s(1),i()),t&2){let e=l().ngIf;n(),v(e.subtitle)}}function Vt(t,a){if(t&1&&(r(0,"li"),s(1),i()),t&2){let e=a.$implicit;n(),v(e)}}function Ht(t,a){if(t&1&&(r(0,"div")(1,"h2"),s(2,"Published"),i(),s(3),d(4,"date"),i()),t&2){let e=l().ngIf;n(3),b(" ",at(4,1,e.published,"longDate")," ")}}function Kt(t,a){if(t&1&&B(0,"img",10),t&2){let e=l().ngIf;m("src",e.thumbnailUrl,D)}}function zt(t,a){if(t&1){let e=rt();it(0),r(1,"button",11),F("confirm",function(){Y(e);let p=l().ngIf,g=l();return Z(g.removeBook(p.isbn))}),s(2," Remove book "),i(),r(3,"a",12),s(4," Edit book "),i(),nt()}if(t&2){let e=l().ngIf;n(3),m("routerLink",st(1,Pt,e.isbn))}}function qt(t,a){if(t&1&&(r(0,"div",1)(1,"h1"),s(2),i(),c(3,Ut,2,1,"p",2),r(4,"div",3)(5,"div")(6,"h2"),s(7,"Authors"),i(),r(8,"ul"),c(9,Vt,2,1,"li",4),i()(),r(10,"div")(11,"h2"),s(12,"ISBN"),i(),s(13),d(14,"isbn"),i(),c(15,Ht,5,4,"div",5),i(),r(16,"h2"),s(17,"Description"),i(),r(18,"p"),s(19),i(),c(20,Kt,1,1,"img",6),r(21,"a",7),s(22,"Back to list"),i(),c(23,zt,5,3,"ng-container",8),i()),t&2){let e=a.ngIf;n(2),v(e.title),n(),m("ngIf",e.subtitle),n(6),m("ngForOf",e.authors),n(4),b(" ",u(14,7,e.isbn)," "),n(2),m("ngIf",e.published),n(4),v(e.description),n(),m("ngIf",e.thumbnailUrl)}}var yt=(()=>{class t{service;route;router;book$;constructor(e,o,p){this.service=e,this.route=o,this.router=p;let g=this.route.snapshot.paramMap.get("isbn");this.book$=this.service.getSingle(g)}removeBook(e){this.service.remove(e).subscribe(()=>{this.router.navigateByUrl("/books")})}static \u0275fac=function(o){return new(o||t)(f(M),f(gt),f(_t))};static \u0275cmp=_({type:t,selectors:[["bm-book-details"]],decls:2,vars:3,consts:[["class","details",4,"ngIf"],[1,"details"],["role","doc-subtitle",4,"ngIf"],[1,"header"],[4,"ngFor","ngForOf"],[4,"ngIf"],["alt","Cover",3,"src",4,"ngIf"],["routerLink","..",1,"button","arrow-left"],[4,"bmLoggedinOnly"],["role","doc-subtitle"],["alt","Cover",3,"src"],["bmConfirm","Remove book?",1,"red",3,"confirm"],[1,"button",3,"routerLink"]],template:function(o,p){o&1&&(c(0,qt,24,9,"div",0),d(1,"async")),o&2&&m("ngIf",u(1,1,p.book$))},dependencies:[x,I,A,xt,It,w,mt,j]})}return t})();var C=T("[Book] Load Books"),O=T("[Book] Load Books Success",U()),N=T("[Book] Load Books Failure",U());var R="book",Gt={books:[],loading:!1},Lt=dt(Gt,$(C,t=>y(h({},t),{loading:!0})),$(O,(t,a)=>y(h({},t),{books:a.data,loading:!1})),$(N,(t,a)=>y(h({},t),{loading:!1})));var Dt=lt(R),Ft=V(Dt,t=>t.loading),wt=V(Dt,t=>t.books);function Jt(t,a){if(t&1&&B(0,"img",6),t&2){let e=l(2);m("src",e.book.thumbnailUrl,D)}}function Qt(t,a){if(t&1&&(r(0,"p",7),s(1),i()),t&2){let e=l(2);n(),b(" ",e.book.subtitle," ")}}function Wt(t,a){if(t&1&&(r(0,"li"),s(1),i()),t&2){let e=a.$implicit;n(),b(" ",e," ")}}function Xt(t,a){if(t&1&&(r(0,"a",1),c(1,Jt,1,1,"img",2),r(2,"h2"),s(3),i(),c(4,Qt,2,1,"p",3),r(5,"ul",4),c(6,Wt,2,1,"li",5),i(),r(7,"div"),s(8),d(9,"isbn"),i()()),t&2){let e=l();m("routerLink",e.book.isbn),n(),m("ngIf",e.book.thumbnailUrl),n(2),v(e.book.title),n(),m("ngIf",e.book.subtitle),n(2),m("ngForOf",e.book.authors),n(2),b("ISBN ",u(9,6,e.book.isbn),"")}}var Tt=(()=>{class t{book;static \u0275fac=function(o){return new(o||t)};static \u0275cmp=_({type:t,selectors:[["bm-book-list-item"]],inputs:{book:"book"},decls:1,vars:1,consts:[["class","list-item",3,"routerLink",4,"ngIf"],[1,"list-item",3,"routerLink"],["alt","Cover",3,"src",4,"ngIf"],["role","doc-subtitle",4,"ngIf"],[1,"comma-list"],[4,"ngFor","ngForOf"],["alt","Cover",3,"src"],["role","doc-subtitle"]],template:function(o,p){o&1&&c(0,Xt,10,8,"a",0),o&2&&m("ngIf",p.book)},dependencies:[x,I,A,j]})}return t})();function Zt(t,a){if(t&1&&(r(0,"li"),B(1,"bm-book-list-item",5),i()),t&2){let e=a.$implicit;n(),m("book",e)}}function te(t,a){t&1&&(r(0,"li"),s(1," No books available. "),i())}function ee(t,a){if(t&1&&(r(0,"ul",2),c(1,Zt,2,1,"li",3)(2,te,2,0,"li",4),i()),t&2){let e=a.ngIf;n(),m("ngForOf",e),n(),m("ngIf",!e.length)}}function oe(t,a){t&1&&(r(0,"div",6),s(1,"Loading ..."),i())}var $t=(()=>{class t{store;books$;loading$;constructor(e){this.store=e,this.books$=this.store.select(wt),this.loading$=this.store.select(Ft),this.store.dispatch(C())}static \u0275fac=function(o){return new(o||t)(f(pt))};static \u0275cmp=_({type:t,selectors:[["bm-book-list"]],decls:6,vars:6,consts:[["class","book-list",4,"ngIf"],["class","loader",4,"ngIf"],[1,"book-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"book"],[1,"loader"]],template:function(o,p){o&1&&(r(0,"h1"),s(1,"Books"),i(),c(2,ee,3,2,"ul",0),d(3,"async"),c(4,oe,2,0,"div",1),d(5,"async")),o&2&&(n(2),m("ngIf",u(3,2,p.books$)),n(2),m("ngIf",u(5,4,p.loading$)))},dependencies:[x,I,Tt,w]})}return t})();var ie=[{path:"",component:$t},{path:":isbn",component:yt}],At=(()=>{class t{static \u0275fac=function(o){return new(o||t)};static \u0275mod=L({type:t});static \u0275inj=S({imports:[H.forChild(ie),H]})}return t})();var Mt=(()=>{class t{actions$;service;loadBooks$=ut(()=>this.actions$.pipe(vt(C),J(()=>this.service.getAll().pipe(q(e=>O({data:e})),G(e=>z(N({error:e.message})))))));constructor(e,o){this.actions$=e,this.service=o}static \u0275fac=function(o){return new(o||t)(P(kt),P(M))};static \u0275prov=W({token:t,factory:t.\u0275fac})}return t})();var Ge=(()=>{class t{static \u0275fac=function(o){return new(o||t)};static \u0275mod=L({type:t});static \u0275inj=S({imports:[ct,At,ft.forFeature(R,Lt),bt.forFeature([Mt])]})}return t})();export{Ge as BooksModule};
