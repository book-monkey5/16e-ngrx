import{b as w,c as G,l as be,m as J,n as ve,o as ge,p as A,q as Be,r as _e,s as xe,t as Ce,u as Ie,v as he}from"./chunk-O3MBXLVS.js";import{$a as Se,Ba as a,Ca as k,Da as b,F as ee,G as te,Ga as fe,Ha as f,Ia as d,Ja as de,L as oe,M as h,P as q,Pa as _,Qa as x,Ra as T,Sa as ue,Ta as ke,U as ie,V as ne,Z as re,Za as ye,a as y,ab as O,b as S,ca as D,cb as Q,d as W,da as n,db as R,ea as l,fa as ae,ha as se,ia as g,ja as L,k as X,ka as E,la as me,m as Y,na as m,qa as s,r as Z,sa as r,ta as i,ua as B,va as pe,wa as ce,xa as le,ya as F,za as c}from"./chunk-A2KTKWJI.js";var $=class e{confirmText;confirm=new re;onClick(){window.confirm(this.confirmText)&&this.confirm.emit()}static \u0275fac=function(t){return new(t||e)};static \u0275dir=E({type:e,selectors:[["","bmConfirm",""]],hostBindings:function(t,p){t&1&&F("click",function(){return p.onClick()})},inputs:{confirmText:[0,"bmConfirm","confirmText"]},outputs:{confirm:"confirm"},standalone:!1})};var N=class e{constructor(o,t,p){this.template=o;this.viewContainer=t;this.authService=p;this.authService.isAuthenticated$.pipe(te(this.destroy$)).subscribe(v=>{v?this.viewContainer.createEmbeddedView(this.template):this.viewContainer.clear()})}destroy$=new W;ngOnDestroy(){this.destroy$.next()}static \u0275fac=function(t){return new(t||e)(l(ae),l(se),l(he))};static \u0275dir=E({type:e,selectors:[["","bmLoggedinOnly",""]],standalone:!1})};var C=class e{transform(o){return o?`${o.substring(0,3)}-${o.substring(3)}`:""}static \u0275fac=function(t){return new(t||e)};static \u0275pipe=me({name:"isbn",type:e,pure:!0,standalone:!1})};var Ue=e=>["/admin/edit",e];function Ve(e,o){if(e&1&&(r(0,"p",9),a(1),i()),e&2){let t=c().ngIf;n(),k(t.subtitle)}}function He(e,o){if(e&1&&(r(0,"li"),a(1),i()),e&2){let t=o.$implicit;n(),k(t)}}function Ke(e,o){if(e&1&&(r(0,"div")(1,"h2"),a(2,"Published"),i(),a(3),f(4,"date"),i()),e&2){let t=c().ngIf;n(3),b(" ",de(4,1,t.published,"longDate")," ")}}function ze(e,o){if(e&1&&B(0,"img",10),e&2){let t=c().ngIf;s("src",t.thumbnailUrl,D)}}function qe(e,o){if(e&1){let t=le();pe(0),r(1,"button",11),F("confirm",function(){ie(t);let v=c().ngIf,Ne=c();return ne(Ne.removeBook(v.isbn))}),a(2," Remove book "),i(),r(3,"a",12),a(4," Edit book "),i(),ce()}if(e&2){let t=c().ngIf;n(3),s("routerLink",fe(1,Ue,t.isbn))}}function Ge(e,o){if(e&1&&(r(0,"div",1)(1,"h1"),a(2),i(),m(3,Ve,2,1,"p",2),r(4,"div",3)(5,"div")(6,"h2"),a(7,"Authors"),i(),r(8,"ul"),m(9,He,2,1,"li",4),i()(),r(10,"div")(11,"h2"),a(12,"ISBN"),i(),a(13),f(14,"isbn"),i(),m(15,Ke,5,4,"div",5),i(),r(16,"h2"),a(17,"Description"),i(),r(18,"p"),a(19),i(),m(20,ze,1,1,"img",6),r(21,"a",7),a(22,"Back to list"),i(),m(23,qe,5,3,"ng-container",8),i()),e&2){let t=o.ngIf;n(2),k(t.title),n(),s("ngIf",t.subtitle),n(6),s("ngForOf",t.authors),n(4),b(" ",d(14,7,t.isbn)," "),n(2),s("ngIf",t.published),n(4),k(t.description),n(),s("ngIf",t.thumbnailUrl)}}var M=class e{constructor(o,t,p){this.service=o;this.route=t;this.router=p;let v=this.route.snapshot.paramMap.get("isbn");this.book$=this.service.getSingle(v)}book$;removeBook(o){this.service.remove(o).subscribe(()=>{this.router.navigateByUrl("/books")})}static \u0275fac=function(t){return new(t||e)(l(R),l(ye),l(Se))};static \u0275cmp=g({type:e,selectors:[["bm-book-details"]],standalone:!1,decls:2,vars:3,consts:[["class","details",4,"ngIf"],[1,"details"],["role","doc-subtitle",4,"ngIf"],[1,"header"],[4,"ngFor","ngForOf"],[4,"ngIf"],["alt","Cover",3,"src",4,"ngIf"],["routerLink","..",1,"button","arrow-left"],[4,"bmLoggedinOnly"],["role","doc-subtitle"],["alt","Cover",3,"src"],["bmConfirm","Remove book?",1,"red",3,"confirm"],[1,"button",3,"routerLink"]],template:function(t,p){t&1&&(m(0,Ge,24,9,"div",0),f(1,"async")),t&2&&s("ngIf",d(1,1,p.book$))},dependencies:[_,x,O,$,N,T,ue,C],encapsulation:2})};var I=w("[Book] Load Books"),j=w("[Book] Load Books Success",G()),P=w("[Book] Load Books Failure",G());var U="book",Je={books:[],loading:!1},Te=Be(Je,A(I,e=>S(y({},e),{loading:!0})),A(j,(e,o)=>S(y({},e),{books:o.data,loading:!1})),A(P,(e,o)=>S(y({},e),{loading:!1})));var Ae=ve(U),Oe=J(Ae,e=>e.loading),Re=J(Ae,e=>e.books);function Qe(e,o){if(e&1&&B(0,"img",6),e&2){let t=c(2);s("src",t.book.thumbnailUrl,D)}}function We(e,o){if(e&1&&(r(0,"p",7),a(1),i()),e&2){let t=c(2);n(),b(" ",t.book.subtitle," ")}}function Xe(e,o){if(e&1&&(r(0,"li"),a(1),i()),e&2){let t=o.$implicit;n(),b(" ",t," ")}}function Ye(e,o){if(e&1&&(r(0,"a",1),m(1,Qe,1,1,"img",2),r(2,"h2"),a(3),i(),m(4,We,2,1,"p",3),r(5,"ul",4),m(6,Xe,2,1,"li",5),i(),r(7,"div"),a(8),f(9,"isbn"),i()()),e&2){let t=c();s("routerLink",t.book.isbn),n(),s("ngIf",t.book.thumbnailUrl),n(2),k(t.book.title),n(),s("ngIf",t.book.subtitle),n(2),s("ngForOf",t.book.authors),n(2),b("ISBN ",d(9,6,t.book.isbn),"")}}var V=class e{book;static \u0275fac=function(t){return new(t||e)};static \u0275cmp=g({type:e,selectors:[["bm-book-list-item"]],inputs:{book:"book"},standalone:!1,decls:1,vars:1,consts:[["class","list-item",3,"routerLink",4,"ngIf"],[1,"list-item",3,"routerLink"],["alt","Cover",3,"src",4,"ngIf"],["role","doc-subtitle",4,"ngIf"],[1,"comma-list"],[4,"ngFor","ngForOf"],["alt","Cover",3,"src"],["role","doc-subtitle"]],template:function(t,p){t&1&&m(0,Ye,10,8,"a",0),t&2&&s("ngIf",p.book)},dependencies:[_,x,O,C],encapsulation:2})};function et(e,o){if(e&1&&(r(0,"li"),B(1,"bm-book-list-item",5),i()),e&2){let t=o.$implicit;n(),s("book",t)}}function tt(e,o){e&1&&(r(0,"li"),a(1," No books available. "),i())}function ot(e,o){if(e&1&&(r(0,"ul",2),m(1,et,2,1,"li",3)(2,tt,2,0,"li",4),i()),e&2){let t=o.ngIf;n(),s("ngForOf",t),n(),s("ngIf",!t.length)}}function it(e,o){e&1&&(r(0,"div",6),a(1,"Loading ..."),i())}var H=class e{constructor(o){this.store=o;this.books$=this.store.select(Re),this.loading$=this.store.select(Oe),this.store.dispatch(I())}books$;loading$;static \u0275fac=function(t){return new(t||e)(l(be))};static \u0275cmp=g({type:e,selectors:[["bm-book-list"]],standalone:!1,decls:6,vars:6,consts:[["class","book-list",4,"ngIf"],["class","loader",4,"ngIf"],[1,"book-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"book"],[1,"loader"]],template:function(t,p){t&1&&(r(0,"h1"),a(1,"Books"),i(),m(2,ot,3,2,"ul",0),f(3,"async"),m(4,it,2,0,"div",1),f(5,"async")),t&2&&(n(2),s("ngIf",d(3,2,p.books$)),n(2),s("ngIf",d(5,4,p.loading$)))},dependencies:[_,x,V,T],encapsulation:2})};var nt=[{path:"",component:H},{path:":isbn",component:M}],K=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=L({type:e});static \u0275inj=h({imports:[Q.forChild(nt),Q]})};var z=class e{actions$=q(xe);service=q(R);loadBooks$=_e(()=>this.actions$.pipe(Ce(I),ee(()=>this.service.getAll().pipe(Y(o=>j({data:o})),Z(o=>X(P({error:o.message})))))));static \u0275fac=function(t){return new(t||e)};static \u0275prov=oe({token:e,factory:e.\u0275fac})};var $e=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=L({type:e});static \u0275inj=h({imports:[ke,K,ge.forFeature(U,Te),Ie.forFeature([z])]})};export{$e as BooksModule};
