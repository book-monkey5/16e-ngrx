"use strict";(self.webpackChunkbook_monkey=self.webpackChunkbook_monkey||[]).push([[61],{6061:(no,k,i)=>{i.r(k),i.d(k,{BooksModule:()=>to});var r=i(6895),u=i(3841),o=i(4650),g=i(6384);let _=(()=>{class t{constructor(){this.confirm=new o.vpe}onClick(){window.confirm(this.confirmText)&&this.confirm.emit()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=o.lG2({type:t,selectors:[["","bmConfirm",""]],hostBindings:function(n,c){1&n&&o.NdJ("click",function(){return c.onClick()})},inputs:{confirmText:["bmConfirm","confirmText"]},outputs:{confirm:"confirm"}}),t})();var Z=i(7579),C=i(2722),T=i(8338);let L=(()=>{class t{constructor(n,c,l){this.template=n,this.viewContainer=c,this.authService=l,this.destroy$=new Z.x,this.authService.isAuthenticated$.pipe((0,C.R)(this.destroy$)).subscribe(a=>{a?this.viewContainer.createEmbeddedView(this.template):this.viewContainer.clear()})}ngOnDestroy(){this.destroy$.next()}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(o.Rgc),o.Y36(o.s_b),o.Y36(T.e))},t.\u0275dir=o.lG2({type:t,selectors:[["","bmLoggedinOnly",""]]}),t})(),d=(()=>{class t{transform(n){return n?`${n.substring(0,3)}-${n.substring(3)}`:""}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275pipe=o.Yjl({name:"isbn",type:t,pure:!0}),t})();function y(t,e){if(1&t&&(o.TgZ(0,"p",9),o._uU(1),o.qZA()),2&t){const n=o.oxw(2);o.xp6(1),o.Oqu(n.book.subtitle)}}function A(t,e){if(1&t&&(o.TgZ(0,"li"),o._uU(1),o.qZA()),2&t){const n=e.$implicit;o.xp6(1),o.Oqu(n)}}function I(t,e){if(1&t&&(o.TgZ(0,"div")(1,"h2"),o._uU(2,"Published"),o.qZA(),o._uU(3),o.ALo(4,"date"),o.qZA()),2&t){const n=o.oxw(2);o.xp6(3),o.hij(" ",o.xi3(4,1,n.book.published,"longDate")," ")}}function U(t,e){if(1&t&&o._UZ(0,"img",10),2&t){const n=o.oxw(2);o.Q6J("src",n.book.thumbnailUrl,o.LSH)}}const F=function(t){return["/admin/edit",t]};function Y(t,e){if(1&t){const n=o.EpF();o.ynx(0),o.TgZ(1,"button",11),o.NdJ("confirm",function(){o.CHM(n);const l=o.oxw(2);return o.KtG(l.removeBook())}),o._uU(2," Remove book "),o.qZA(),o.TgZ(3,"a",12),o._uU(4," Edit book "),o.qZA(),o.BQk()}if(2&t){const n=o.oxw(2);o.xp6(3),o.Q6J("routerLink",o.VKq(1,F,n.book.isbn))}}function D(t,e){if(1&t&&(o.TgZ(0,"div",1)(1,"h1"),o._uU(2),o.qZA(),o.YNc(3,y,2,1,"p",2),o.TgZ(4,"div",3)(5,"div")(6,"h2"),o._uU(7,"Authors"),o.qZA(),o.TgZ(8,"ul"),o.YNc(9,A,2,1,"li",4),o.qZA()(),o.TgZ(10,"div")(11,"h2"),o._uU(12,"ISBN"),o.qZA(),o._uU(13),o.ALo(14,"isbn"),o.qZA(),o.YNc(15,I,5,4,"div",5),o.qZA(),o.TgZ(16,"h2"),o._uU(17,"Description"),o.qZA(),o.TgZ(18,"p"),o._uU(19),o.qZA(),o.YNc(20,U,1,1,"img",6),o.TgZ(21,"a",7),o._uU(22,"Back to list"),o.qZA(),o.YNc(23,Y,5,3,"ng-container",8),o.qZA()),2&t){const n=o.oxw();o.xp6(2),o.Oqu(n.book.title),o.xp6(1),o.Q6J("ngIf",n.book.subtitle),o.xp6(6),o.Q6J("ngForOf",n.book.authors),o.xp6(4),o.hij(" ",o.lcZ(14,7,n.book.isbn)," "),o.xp6(2),o.Q6J("ngIf",n.book.published),o.xp6(4),o.Oqu(n.book.description),o.xp6(1),o.Q6J("ngIf",n.book.thumbnailUrl)}}let J=(()=>{class t{constructor(n,c,l){this.service=n,this.route=c,this.router=l;const a=this.route.snapshot.paramMap.get("isbn");this.service.getSingle(a).subscribe(p=>{this.book=p})}removeBook(){this.book&&this.service.remove(this.book.isbn).subscribe(()=>{this.router.navigateByUrl("/books")})}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(g.T),o.Y36(u.gz),o.Y36(u.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["bm-book-details"]],decls:1,vars:1,consts:[["class","details",4,"ngIf"],[1,"details"],["role","doc-subtitle",4,"ngIf"],[1,"header"],[4,"ngFor","ngForOf"],[4,"ngIf"],["alt","Cover",3,"src",4,"ngIf"],["routerLink","..",1,"button","arrow-left"],[4,"bmLoggedinOnly"],["role","doc-subtitle"],["alt","Cover",3,"src"],["bmConfirm","Remove book?",1,"red",3,"confirm"],[1,"button",3,"routerLink"]],template:function(n,c){1&n&&o.YNc(0,D,24,9,"div",0),2&n&&o.Q6J("ngIf",c.book)},dependencies:[r.sg,r.O5,u.yS,_,L,r.uU,d]}),t})();var s=i(9653);const f=(0,s.PH)("[Book] Load Books"),b=(0,s.PH)("[Book] Load Books Success",(0,s.Ky)()),h=(0,s.PH)("[Book] Load Books Failure",(0,s.Ky)()),v="book",Q=(0,s.Lq)({books:[],loading:!1},(0,s.on)(f,t=>({...t,loading:!0})),(0,s.on)(b,(t,e)=>({...t,books:e.data,loading:!1})),(0,s.on)(h,(t,e)=>({...t,loading:!1}))),B=(0,s.ZF)(v),N=(0,s.P1)(B,t=>t.loading),x=(0,s.P1)(B,t=>t.books);function q(t,e){if(1&t&&o._UZ(0,"img",6),2&t){const n=o.oxw(2);o.Q6J("src",n.book.thumbnailUrl,o.LSH)}}function w(t,e){if(1&t&&(o.TgZ(0,"p",7),o._uU(1),o.qZA()),2&t){const n=o.oxw(2);o.xp6(1),o.hij(" ",n.book.subtitle," ")}}function S(t,e){if(1&t&&(o.TgZ(0,"li"),o._uU(1),o.qZA()),2&t){const n=e.$implicit;o.xp6(1),o.hij(" ",n," ")}}function $(t,e){if(1&t&&(o.TgZ(0,"a",1),o.YNc(1,q,1,1,"img",2),o.TgZ(2,"h2"),o._uU(3),o.qZA(),o.YNc(4,w,2,1,"p",3),o.TgZ(5,"ul",4),o.YNc(6,S,2,1,"li",5),o.qZA(),o.TgZ(7,"div"),o._uU(8),o.ALo(9,"isbn"),o.qZA()()),2&t){const n=o.oxw();o.Q6J("routerLink",n.book.isbn),o.xp6(1),o.Q6J("ngIf",n.book.thumbnailUrl),o.xp6(2),o.Oqu(n.book.title),o.xp6(1),o.Q6J("ngIf",n.book.subtitle),o.xp6(2),o.Q6J("ngForOf",n.book.authors),o.xp6(2),o.hij("ISBN ",o.lcZ(9,6,n.book.isbn),"")}}let M=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["bm-book-list-item"]],inputs:{book:"book"},decls:1,vars:1,consts:[[3,"routerLink",4,"ngIf"],[3,"routerLink"],["alt","Cover",3,"src",4,"ngIf"],["role","doc-subtitle",4,"ngIf"],[1,"comma-list"],[4,"ngFor","ngForOf"],["alt","Cover",3,"src"],["role","doc-subtitle"]],template:function(n,c){1&n&&o.YNc(0,$,10,8,"a",0),2&n&&o.Q6J("ngIf",c.book)},dependencies:[r.sg,r.O5,u.yS,d]}),t})();function j(t,e){if(1&t&&(o.TgZ(0,"li"),o._UZ(1,"bm-book-list-item",5),o.qZA()),2&t){const n=e.$implicit;o.xp6(1),o.Q6J("book",n)}}function H(t,e){1&t&&(o.TgZ(0,"li"),o._uU(1," No books available. "),o.qZA())}function P(t,e){if(1&t&&(o.TgZ(0,"ul",2),o.YNc(1,j,2,1,"li",3),o.YNc(2,H,2,0,"li",4),o.qZA()),2&t){const n=e.ngIf;o.xp6(1),o.Q6J("ngForOf",n),o.xp6(1),o.Q6J("ngIf",!n.length)}}function E(t,e){1&t&&(o.TgZ(0,"div",6),o._uU(1,"Loading ..."),o.qZA())}const G=[{path:"",component:(()=>{class t{constructor(n){this.store=n,this.books$=this.store.select(x),this.loading$=this.store.select(N),this.store.dispatch(f())}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(s.yh))},t.\u0275cmp=o.Xpm({type:t,selectors:[["bm-book-list"]],decls:6,vars:6,consts:[["class","book-list",4,"ngIf"],["class","loader",4,"ngIf"],[1,"book-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"book"],[1,"loader"]],template:function(n,c){1&n&&(o.TgZ(0,"h1"),o._uU(1,"Books"),o.qZA(),o.YNc(2,P,3,2,"ul",0),o.ALo(3,"async"),o.YNc(4,E,2,0,"div",1),o.ALo(5,"async")),2&n&&(o.xp6(2),o.Q6J("ngIf",o.lcZ(3,2,c.books$)),o.xp6(2),o.Q6J("ngIf",o.lcZ(5,4,c.loading$)))},dependencies:[r.sg,r.O5,M,r.Ov]}),t})()},{path:":isbn",component:J}];let R=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[u.Bz.forChild(G),u.Bz]}),t})();var m=i(2655),K=i(9300),z=i(3900),X=i(4004),V=i(262),W=i(9646);let oo=(()=>{class t{constructor(n,c,l){this.actions$=n,this.service=c,this.store=l,this.loadBooks$=(0,m.GW)(()=>this.actions$.pipe((0,m.l4)(f),(0,m.IC)(()=>this.store.select(x)),(0,K.h)(([a,p])=>!p.length),(0,z.w)(()=>this.service.getAll().pipe((0,X.U)(a=>b({data:a})),(0,V.K)(a=>(0,W.of)(h({error:a.message})))))))}}return t.\u0275fac=function(n){return new(n||t)(o.LFG(m.eX),o.LFG(g.T),o.LFG(s.yh))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac}),t})(),to=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[r.ez,R,s.Aw.forFeature(v,Q),m.sQ.forFeature([oo])]}),t})()}}]);